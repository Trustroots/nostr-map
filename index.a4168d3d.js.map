{"mappings":"C,A,S,C,C,C,C,C,C,C,C,C,E,I,E,A,a,O,W,W,A,a,O,K,K,A,a,O,O,O,A,a,O,O,O,C,E,E,A,Y,O,C,C,E,E,C,C,E,C,E,E,K,E,C,E,E,A,a,O,Q,A,Y,O,O,O,E,O,O,C,I,C,Q,S,E,C,C,C,E,G,C,C,C,E,C,C,G,C,C,C,E,C,C,I,E,A,Y,O,C,C,E,E,C,C,E,C,G,C,G,E,O,E,E,C,G,G,E,O,E,E,C,G,G,G,A,U,O,E,O,E,G,I,E,A,M,uB,E,I,O,E,I,C,mB,C,C,E,O,C,S,C,E,I,E,C,C,E,C,E,C,E,C,O,A,M,E,E,C,E,E,K,C,C,E,I,E,C,C,E,C,I,E,M,C,G,C,C,E,C,E,C,I,C,E,O,C,E,E,E,O,C,I,C,C,O,C,C,E,C,O,C,S,E,C,E,I,E,E,O,C,G,M,A,C,I,E,C,E,E,E,C,C,E,e,C,C,E,E,M,C,S,C,E,I,C,E,C,E,I,C,M,C,E,I,C,O,C,C,C,E,E,O,C,E,E,K,C,E,E,M,C,E,E,Q,C,S,C,C,C,E,C,C,E,C,C,S,C,C,C,E,E,O,C,C,E,C,E,A,E,O,c,C,E,O,C,I,W,O,C,C,E,A,C,G,C,C,E,C,E,I,I,E,E,E,E,M,C,I,E,C,C,E,E,G,E,C,I,E,E,E,A,C,U,O,S,A,a,O,O,O,O,C,E,Y,O,Q,O,G,E,O,W,O,C,E,C,E,C,M,C,S,C,C,C,C,C,E,I,E,E,kD,E,iB,C,GCgBa,EAAA,MAAA,CAAA,EAAA,UAAA,IAAA,GAhBb,IAAA,EAAA,EAAA,WACA,EAAA,EAAA,YACA,EAAA,EAAA,SACA,EAAA,EAAA,WACA,EAAA,EAAA,gBAOA,EAAA,EAAA,kBACA,EAAA,EAAA,gBACA,EAAA,EAAA,aACA,EAAA,EAAA,gBAEO,IAAM,EAAU,UACrB,IAAM,EAAa,MAAM,AAAA,CAAA,EAAA,EAAA,aAAa,AAAb,GAGzB,CADiB,SAAS,cAAc,CAAC,QAChC,OAAO,CAAG,AAAC,IAClB,EAAM,cAAc,GACpB,AAAA,CAAA,EAAA,EAAA,iBAAgB,AAAhB,GACF,EAEA,IAAM,EAAc,SAAS,cAAc,CAAC,WACxB,QAAhB,GACF,CAAA,EAAY,WAAW,CAAG,AAAA,EAAA,SA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","sources":["<anon>","src/startup.ts","build.ts","src/welcome.ts","src/nostr/nip5.ts"],"sourcesContent":["// modules are defined as an array\n// [ module function, map of requires ]\n//\n// map of requires is short require name -> numeric require\n//\n// anything defined in a previous bundle is accessed via the\n// orig method which is the require for previous bundles\n\n(function (modules, entry, mainEntry, parcelRequireName, globalName) {\n  /* eslint-disable no-undef */\n  var globalObject =\n    typeof globalThis !== 'undefined'\n      ? globalThis\n      : typeof self !== 'undefined'\n      ? self\n      : typeof window !== 'undefined'\n      ? window\n      : typeof global !== 'undefined'\n      ? global\n      : {};\n  /* eslint-enable no-undef */\n\n  // Save the require from previous bundle to this closure if any\n  var previousRequire =\n    typeof globalObject[parcelRequireName] === 'function' &&\n    globalObject[parcelRequireName];\n\n  var cache = previousRequire.cache || {};\n  // Do not use `require` to prevent Webpack from trying to bundle this call\n  var nodeRequire =\n    typeof module !== 'undefined' &&\n    typeof module.require === 'function' &&\n    module.require.bind(module);\n\n  function newRequire(name, jumped) {\n    if (!cache[name]) {\n      if (!modules[name]) {\n        // if we cannot find the module within our internal map or\n        // cache jump to the current global require ie. the last bundle\n        // that was added to the page.\n        var currentRequire =\n          typeof globalObject[parcelRequireName] === 'function' &&\n          globalObject[parcelRequireName];\n        if (!jumped && currentRequire) {\n          return currentRequire(name, true);\n        }\n\n        // If there are other bundles on this page the require from the\n        // previous one is saved to 'previousRequire'. Repeat this as\n        // many times as there are bundles until the module is found or\n        // we exhaust the require chain.\n        if (previousRequire) {\n          return previousRequire(name, true);\n        }\n\n        // Try the node require function if it exists.\n        if (nodeRequire && typeof name === 'string') {\n          return nodeRequire(name);\n        }\n\n        var err = new Error(\"Cannot find module '\" + name + \"'\");\n        err.code = 'MODULE_NOT_FOUND';\n        throw err;\n      }\n\n      localRequire.resolve = resolve;\n      localRequire.cache = {};\n\n      var module = (cache[name] = new newRequire.Module(name));\n\n      modules[name][0].call(\n        module.exports,\n        localRequire,\n        module,\n        module.exports,\n        this\n      );\n    }\n\n    return cache[name].exports;\n\n    function localRequire(x) {\n      var res = localRequire.resolve(x);\n      return res === false ? {} : newRequire(res);\n    }\n\n    function resolve(x) {\n      var id = modules[name][1][x];\n      return id != null ? id : x;\n    }\n  }\n\n  function Module(moduleName) {\n    this.id = moduleName;\n    this.bundle = newRequire;\n    this.exports = {};\n  }\n\n  newRequire.isParcelRequire = true;\n  newRequire.Module = Module;\n  newRequire.modules = modules;\n  newRequire.cache = cache;\n  newRequire.parent = previousRequire;\n  newRequire.register = function (id, exports) {\n    modules[id] = [\n      function (require, module) {\n        module.exports = exports;\n      },\n      {},\n    ];\n  };\n\n  Object.defineProperty(newRequire, 'root', {\n    get: function () {\n      return globalObject[parcelRequireName];\n    },\n  });\n\n  globalObject[parcelRequireName] = newRequire;\n\n  for (var i = 0; i < entry.length; i++) {\n    newRequire(entry[i]);\n  }\n\n  if (mainEntry) {\n    // Expose entry point to Node, AMD or browser globals\n    // Based on https://github.com/ForbesLindesay/umd/blob/master/template.js\n    var mainExports = newRequire(mainEntry);\n\n    // CommonJS\n    if (typeof exports === 'object' && typeof module !== 'undefined') {\n      module.exports = mainExports;\n\n      // RequireJS\n    } else if (typeof define === 'function' && define.amd) {\n      define(function () {\n        return mainExports;\n      });\n\n      // <script>\n    } else if (globalName) {\n      this[globalName] = mainExports;\n    }\n  }\n})({\"dB2Fs\":[function(require,module,exports) {\nvar parcelHelpers = require(\"@parcel/transformer-js/src/esmodule-helpers.js\");\nparcelHelpers.defineInteropFlag(exports);\nparcelHelpers.export(exports, \"startup\", ()=>startup);\nvar _leaflet = require(\"leaflet\");\nvar _build = require(\"../build\");\nvar _map = require(\"./map\");\nvar _nostr = require(\"./nostr\");\nvar _keys = require(\"./nostr/keys\");\nvar _relays = require(\"./nostr/relays\");\nvar _onboarding = require(\"./onboarding\");\nvar _welcome = require(\"./welcome\");\nvar _nip5 = require(\"./nostr/nip5\");\nconst startup = async ()=>{\n    const isLoggedIn = await (0, _keys.hasPrivateKey)();\n    const helpLink = document.getElementById(\"help\");\n    helpLink.onclick = (event)=>{\n        event.preventDefault();\n        (0, _map.hackSidePanelOpen)();\n    };\n    const buildIdSpan = document.getElementById(\"build-id\");\n    if (buildIdSpan !== null) buildIdSpan.textContent = (0, _build.BUILD_SHA) || \"local\";\n    const loggedIn = _leaflet.DomUtil.get(\"loggedIn\");\n    const loggedOut = _leaflet.DomUtil.get(\"loggedOut\");\n    if (isLoggedIn) {\n        (0, _nip5.validateNip5)();\n        _leaflet.DomUtil.addClass(loggedIn, \"show\");\n        _leaflet.DomUtil.addClass(loggedOut, \"hide\");\n        const signoutButton = document.getElementById(\"signout\");\n        signoutButton.onclick = async ()=>{\n            await (0, _keys.unsetPrivateKey)();\n            globalThis.location.reload();\n        };\n        const npubPublicKey = await (0, _keys.getNpubPublicKey)();\n        const nsecPrivateKey = await (0, _keys.getNsecPrivateKey)();\n        const publicKeyCode = globalThis.document.getElementById(\"npubPublicKey\");\n        const link = document.createElement(\"a\");\n        link.href = `https://njump.me/${npubPublicKey}`;\n        link.target = \"_blank\";\n        link.innerText = npubPublicKey;\n        publicKeyCode.appendChild(link);\n        const nsecPrivateKeyCode = globalThis.document.getElementById(\"nsecPrivateKey\");\n        nsecPrivateKeyCode.innerText = nsecPrivateKey;\n    } else {\n        _leaflet.DomUtil.addClass(loggedIn, \"hide\");\n        _leaflet.DomUtil.addClass(loggedOut, \"show\");\n        const signupButton = document.getElementById(\"signup\");\n        signupButton.onclick = ()=>{\n            (0, _onboarding.startUserOnboarding)();\n            (0, _map.hackSidePanelClosed)();\n        };\n    }\n    const relaysInput = document.getElementById(\"relays\");\n    const relays = await (0, _nostr.getRelays)();\n    const relaysJson = JSON.stringify(relays);\n    relaysInput.value = relaysJson;\n    const relaySubmitButton = document.getElementById(\"relays_submit\");\n    relaySubmitButton.onclick = async (event)=>{\n        event.preventDefault();\n        relaySubmitButton.setAttribute(\"disabled\", \"disabled\");\n        const relaysJson = relaysInput.value;\n        try {\n            const relaysFromJson = JSON.parse(relaysJson);\n            if (!Array.isArray(relaysFromJson)) {\n                relaySubmitButton.removeAttribute(\"disabled\");\n                globalThis.alert(\"Invalid relays submitted. Please try again.\");\n                return;\n            }\n            const relays = relaysFromJson.length === 0 ? (0, _relays.getDefaultRelays)() : relaysFromJson;\n            await (0, _nostr.setRelays)({\n                relays\n            });\n            globalThis.alert(\"Relays saved.\");\n            globalThis.document.location.reload();\n        } catch (error) {\n            relaySubmitButton.removeAttribute(\"disabled\");\n            globalThis.alert(`#vRuf1N Error saving relays\\n${error.toString()}`);\n        }\n    };\n    (0, _welcome.startWelcomeSequence)();\n};\nstartup();\n\n},{\"leaflet\":\"fJCTE\",\"../build\":\"9Tstj\",\"./map\":\"89CD3\",\"./nostr\":\"batwW\",\"./nostr/keys\":\"8qDuN\",\"./nostr/relays\":\"esJOU\",\"./onboarding\":\"35kbs\",\"./welcome\":\"epjYR\",\"./nostr/nip5\":\"5uBnK\",\"@parcel/transformer-js/src/esmodule-helpers.js\":\"k3151\"}],\"9Tstj\":[function(require,module,exports) {\nvar parcelHelpers = require(\"@parcel/transformer-js/src/esmodule-helpers.js\");\nparcelHelpers.defineInteropFlag(exports);\nparcelHelpers.export(exports, \"BUILD_SHA\", ()=>BUILD_SHA);\nconst BUILD_SHA = \"c52c3b76366767054281182750513d2113a4d669\";\n\n},{\"@parcel/transformer-js/src/esmodule-helpers.js\":\"k3151\"}],\"epjYR\":[function(require,module,exports) {\nvar parcelHelpers = require(\"@parcel/transformer-js/src/esmodule-helpers.js\");\nparcelHelpers.defineInteropFlag(exports);\nparcelHelpers.export(exports, \"startWelcomeSequence\", ()=>startWelcomeSequence);\nvar _sweetalert2 = require(\"sweetalert2\");\nvar _sweetalert2Default = parcelHelpers.interopDefault(_sweetalert2);\nvar _keys = require(\"./nostr/keys\");\nvar _utils = require(\"./utils\");\nconst startWelcomeSequence = async ()=>{\n    const isLoggedIn = await (0, _keys.hasPrivateKey)();\n    if (isLoggedIn) return;\n    if (!await (0, _utils.confirmYesNo)(`Notes is an experimental feature using an open developed protocol called NOSTR. Continue?`)) {\n        await (0, _sweetalert2Default.default).fire({\n            text: `This will become more user friendly in the future. Feel free to come back anytime. Now we'll take you back to the main trustroots site.`\n        });\n        globalThis.location.href = `http://www.trustroots.org/search`;\n        return;\n    }\n    (0, _sweetalert2Default.default).fire({\n        text: `Great. Browse map to see other people's notes and right click (or long press on mobile) to add your own note. `\n    });\n};\n\n},{\"sweetalert2\":\"d7K5G\",\"./nostr/keys\":\"8qDuN\",\"./utils\":\"i8jxn\",\"@parcel/transformer-js/src/esmodule-helpers.js\":\"k3151\"}],\"5uBnK\":[function(require,module,exports) {\nvar parcelHelpers = require(\"@parcel/transformer-js/src/esmodule-helpers.js\");\nparcelHelpers.defineInteropFlag(exports);\nparcelHelpers.export(exports, \"validateNip5\", ()=>validateNip5);\nvar _constants = require(\"../constants\");\nvar _router = require(\"../router\");\nvar _utils = require(\"../utils\");\nvar _keys = require(\"./keys\");\nconst validateNip5 = async ()=>{\n    try {\n        const username = (0, _router.getTrustrootsUsernameFromLocation)();\n        if (username.length < 3) {\n            (0, _utils.alert)(`Sorry, you need to click to this page from trustroots.org. Without doing that, this site won't work properly. Please go to www.trustroots.org and click the Notes link to come back here. #wBjsEe`, `You need to click from trustroots`);\n            return;\n        }\n        const result = await fetch(`${(0, _constants.TRUSTROOTS_NIP5_URL)}?name=${username}`);\n        const nip5 = await result.json();\n        const nip5PublicKey = nip5.names?.[username];\n        const localPublicKey = await (0, _keys.getPublicKey)();\n        if (nip5PublicKey !== localPublicKey) (0, _utils.alert)(`Your key doesn't match trustroots. Posting to the map will not work. Please sign out and sign in again with the nsec key that matches your trustroots npub key. #H9bEe2`, \"Fatal error\");\n    } catch (error) {\n        (0, _utils.alert)(error, `Unexpected error`);\n    }\n};\n\n},{\"../constants\":\"7NbOs\",\"../router\":\"9sDGW\",\"../utils\":\"i8jxn\",\"./keys\":\"8qDuN\",\"@parcel/transformer-js/src/esmodule-helpers.js\":\"k3151\"}]},[\"dB2Fs\"], \"dB2Fs\", \"parcelRequire31ee\")\n\n//# sourceMappingURL=index.a4168d3d.js.map\n","import * as L from \"leaflet\";\nimport { BUILD_SHA } from \"../build\";\nimport { hackSidePanelClosed, hackSidePanelOpen } from \"./map\";\nimport { getRelays, setRelays } from \"./nostr\";\nimport {\n  getNpubPublicKey,\n  getNsecPrivateKey,\n  getPublicKey,\n  hasPrivateKey,\n  unsetPrivateKey,\n} from \"./nostr/keys\";\nimport { getDefaultRelays } from \"./nostr/relays\";\nimport { startUserOnboarding } from \"./onboarding\";\nimport { startWelcomeSequence } from \"./welcome\";\nimport { validateNip5 } from \"./nostr/nip5\";\n\nexport const startup = async () => {\n  const isLoggedIn = await hasPrivateKey();\n\n  const helpLink = document.getElementById(\"help\")!;\n  helpLink.onclick = (event) => {\n    event.preventDefault();\n    hackSidePanelOpen();\n  };\n\n  const buildIdSpan = document.getElementById(\"build-id\");\n  if (buildIdSpan !== null) {\n    buildIdSpan.textContent = BUILD_SHA || \"local\";\n  }\n\n  const loggedIn = L.DomUtil.get(\"loggedIn\")!;\n  const loggedOut = L.DomUtil.get(\"loggedOut\")!;\n\n  if (isLoggedIn) {\n    validateNip5();\n\n    L.DomUtil.addClass(loggedIn, \"show\");\n    L.DomUtil.addClass(loggedOut, \"hide\");\n\n    const signoutButton = document.getElementById(\"signout\")!;\n    signoutButton.onclick = async () => {\n      await unsetPrivateKey();\n      globalThis.location.reload();\n    };\n\n    const npubPublicKey = await getNpubPublicKey();\n    const nsecPrivateKey = await getNsecPrivateKey();\n\n    const publicKeyCode = globalThis.document.getElementById(\"npubPublicKey\")!;\n    const link = document.createElement(\"a\");\n    link.href = `https://njump.me/${npubPublicKey}`;\n    link.target = \"_blank\";\n    link.innerText = npubPublicKey;\n    publicKeyCode.appendChild(link);\n    const nsecPrivateKeyCode =\n      globalThis.document.getElementById(\"nsecPrivateKey\")!;\n    nsecPrivateKeyCode.innerText = nsecPrivateKey;\n  } else {\n    L.DomUtil.addClass(loggedIn, \"hide\");\n    L.DomUtil.addClass(loggedOut, \"show\");\n\n    const signupButton = document.getElementById(\"signup\")!;\n    signupButton.onclick = () => {\n      startUserOnboarding();\n      hackSidePanelClosed();\n    };\n  }\n\n  const relaysInput = document.getElementById(\"relays\") as HTMLInputElement;\n  const relays = await getRelays();\n  const relaysJson = JSON.stringify(relays);\n  relaysInput.value = relaysJson;\n\n  const relaySubmitButton = document.getElementById(\"relays_submit\")!;\n  relaySubmitButton.onclick = async (event) => {\n    event.preventDefault();\n    relaySubmitButton.setAttribute(\"disabled\", \"disabled\");\n\n    const relaysJson = relaysInput.value;\n    try {\n      const relaysFromJson = JSON.parse(relaysJson) as string[];\n      if (!Array.isArray(relaysFromJson)) {\n        relaySubmitButton.removeAttribute(\"disabled\");\n        globalThis.alert(\"Invalid relays submitted. Please try again.\");\n        return;\n      }\n      const relays =\n        relaysFromJson.length === 0 ? getDefaultRelays() : relaysFromJson;\n      await setRelays({ relays });\n      globalThis.alert(\"Relays saved.\");\n      globalThis.document.location.reload();\n    } catch (error) {\n      relaySubmitButton.removeAttribute(\"disabled\");\n      globalThis.alert(`#vRuf1N Error saving relays\\n${error.toString()}`);\n    }\n  };\n\n  startWelcomeSequence();\n};\nstartup();\n","export const BUILD_SHA = \"c52c3b76366767054281182750513d2113a4d669\";\n","import Swal from \"sweetalert2\";\nimport { hasPrivateKey } from \"./nostr/keys\";\nimport { confirmYesNo } from \"./utils\";\n\nexport const startWelcomeSequence = async () => {\n  const isLoggedIn = await hasPrivateKey();\n  if (isLoggedIn) {\n    return;\n  }\n\n  if (\n    !(await confirmYesNo(\n      `Notes is an experimental feature using an open developed protocol called NOSTR. Continue?`\n    ))\n  ) {\n    await Swal.fire({\n      text: `This will become more user friendly in the future. Feel free to come back anytime. Now we'll take you back to the main trustroots site.`,\n    });\n    globalThis.location.href = `http://www.trustroots.org/search`;\n    return;\n  }\n\n  Swal.fire({\n    text: `Great. Browse map to see other people's notes and right click (or long press on mobile) to add your own note. `,\n  });\n};\n","import { TRUSTROOTS_NIP5_URL } from \"../constants\";\nimport { getTrustrootsUsernameFromLocation } from \"../router\";\nimport { alert } from \"../utils\";\nimport { getPublicKey } from \"./keys\";\n\nexport const validateNip5 = async () => {\n  try {\n    const username = getTrustrootsUsernameFromLocation();\n    if (username.length < 3) {\n      alert(\n        `Sorry, you need to click to this page from trustroots.org. Without doing that, this site won't work properly. Please go to www.trustroots.org and click the Notes link to come back here. #wBjsEe`,\n        `You need to click from trustroots`\n      );\n      return;\n    }\n\n    const result = await fetch(`${TRUSTROOTS_NIP5_URL}?name=${username}`);\n    const nip5 = (await result.json()) as {\n      names: { [username: string]: string };\n    };\n    const nip5PublicKey = nip5.names?.[username];\n    const localPublicKey = await getPublicKey();\n    if (nip5PublicKey !== localPublicKey) {\n      alert(\n        `Your key doesn't match trustroots. Posting to the map will not work. Please sign out and sign in again with the nsec key that matches your trustroots npub key. #H9bEe2`,\n        \"Fatal error\"\n      );\n    }\n  } catch (error) {\n    alert(error, `Unexpected error`);\n  }\n};\n"],"names":["modules","entry","mainEntry","parcelRequireName","globalName","globalObject","globalThis","self","window","global","previousRequire","cache","nodeRequire","module","require","bind","newRequire","name","jumped","currentRequire","err","Error","code","localRequire","resolve","x","id","Module","call","exports","res","isParcelRequire","moduleName","bundle","parent","register","Object","defineProperty","get","i","length","mainExports","define","amd","parcelHelpers","defineInteropFlag","export","startup","_leaflet","_build","_map","_nostr","_keys","_relays","_onboarding","_welcome","_nip5","isLoggedIn","hasPrivateKey","helpLink","document","getElementById","onclick","event","preventDefault","hackSidePanelOpen","buildIdSpan","textContent","BUILD_SHA","loggedIn","DomUtil","loggedOut","validateNip5","addClass","signoutButton","unsetPrivateKey","location","reload","npubPublicKey","getNpubPublicKey","nsecPrivateKey","getNsecPrivateKey","publicKeyCode","link","createElement","href","target","innerText","appendChild","nsecPrivateKeyCode","signupButton","startUserOnboarding","hackSidePanelClosed","relaysInput","relaysJson","JSON","stringify","getRelays","value","relaySubmitButton","setAttribute","relaysFromJson","parse","Array","isArray","removeAttribute","alert","relays","getDefaultRelays","setRelays","error","toString","startWelcomeSequence","_sweetalert2","_sweetalert2Default","interopDefault","_utils","confirmYesNo","default","fire","text","_constants","_router","username","getTrustrootsUsernameFromLocation","result","fetch","TRUSTROOTS_NIP5_URL","nip5","json","nip5PublicKey","names","localPublicKey","getPublicKey"],"version":3,"file":"index.a4168d3d.js.map"}