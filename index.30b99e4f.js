!function(e,t,r,o,n){var s="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},l="function"==typeof s[o]&&s[o],a=l.cache||{},i="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function u(t,r){if(!a[t]){if(!e[t]){var n="function"==typeof s[o]&&s[o];if(!r&&n)return n(t,!0);if(l)return l(t,!0);if(i&&"string"==typeof t)return i(t);var d=Error("Cannot find module '"+t+"'");throw d.code="MODULE_NOT_FOUND",d}f.resolve=function(r){var o=e[t][1][r];return null!=o?o:r},f.cache={};var c=a[t]=new u.Module(t);e[t][0].call(c.exports,f,c,c.exports,this)}return a[t].exports;function f(e){var t=f.resolve(e);return!1===t?{}:u(t)}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=a,u.parent=l,u.register=function(t,r){e[t]=[function(e,t){t.exports=r},{}]},Object.defineProperty(u,"root",{get:function(){return s[o]}}),s[o]=u;for(var d=0;d<t.length;d++)u(t[d]);if(r){var c=u(r);"object"==typeof exports&&"undefined"!=typeof module?module.exports=c:"function"==typeof define&&define.amd&&define(function(){return c})}}({dB2Fs:[function(e,t,r){var o=e("@parcel/transformer-js/src/esmodule-helpers.js");o.defineInteropFlag(r),o.export(r,"startup",()=>p);var n=e("leaflet"),s=e("../build"),l=e("./map"),a=e("./nostr"),i=e("./nostr/keys"),u=e("./nostr/relays"),d=e("./onboarding"),c=e("./welcome"),f=e("./nostr/nip5");let p=async()=>{let e=await (0,i.hasPrivateKey)();document.getElementById("help").onclick=e=>{e.preventDefault(),(0,l.hackSidePanelOpen)()};let t=document.getElementById("build-id");null!==t&&(t.textContent=s.BUILD_SHA||"local");let r=n.DomUtil.get("loggedIn"),o=n.DomUtil.get("loggedOut");if(e){(0,f.validateNip5)(),n.DomUtil.addClass(r,"show"),n.DomUtil.addClass(o,"hide"),document.getElementById("signout").onclick=async()=>{await (0,i.unsetPrivateKey)(),globalThis.location.reload()};let e=await (0,i.getNpubPublicKey)(),t=await (0,i.getNsecPrivateKey)(),s=globalThis.document.getElementById("npubPublicKey"),l=document.createElement("a");l.href=`https://njump.me/${e}`,l.target="_blank",l.innerText=e,s.appendChild(l),globalThis.document.getElementById("nsecPrivateKey").innerText=t}else n.DomUtil.addClass(r,"hide"),n.DomUtil.addClass(o,"show"),document.getElementById("signup").onclick=()=>{(0,d.startUserOnboarding)(),(0,l.hackSidePanelClosed)()};let p=document.getElementById("relays"),m=JSON.stringify(await (0,a.getRelays)());p.value=m;let y=document.getElementById("relays_submit");y.onclick=async e=>{e.preventDefault(),y.setAttribute("disabled","disabled");let t=p.value;try{let e=JSON.parse(t);if(!Array.isArray(e)){y.removeAttribute("disabled"),globalThis.alert("Invalid relays submitted. Please try again.");return}let r=0===e.length?(0,u.getDefaultRelays)():e;await (0,a.setRelays)({relays:r}),globalThis.alert("Relays saved."),globalThis.document.location.reload()}catch(e){y.removeAttribute("disabled"),globalThis.alert(`#vRuf1N Error saving relays
${e.toString()}`)}},(0,c.startWelcomeSequence)()};p()},{leaflet:"fJCTE","../build":"9Tstj","./map":"89CD3","./nostr":"batwW","./nostr/keys":"8qDuN","./nostr/relays":"esJOU","./onboarding":"35kbs","./welcome":"epjYR","./nostr/nip5":"5uBnK","@parcel/transformer-js/src/esmodule-helpers.js":"k3151"}],"9Tstj":[function(e,t,r){var o=e("@parcel/transformer-js/src/esmodule-helpers.js");o.defineInteropFlag(r),o.export(r,"BUILD_SHA",()=>n);let n="e77ce2e4e7333fc0f753b1914923bb2cfdc7db0f"},{"@parcel/transformer-js/src/esmodule-helpers.js":"k3151"}],epjYR:[function(e,t,r){var o=e("@parcel/transformer-js/src/esmodule-helpers.js");o.defineInteropFlag(r),o.export(r,"startWelcomeSequence",()=>i);var n=e("sweetalert2"),s=o.interopDefault(n),l=e("./nostr/keys"),a=e("./utils");let i=async()=>{if(!await (0,l.hasPrivateKey)()){if(!await (0,a.confirmYesNo)("Notes is an experimental feature using an open developed protocol called NOSTR. Continue?")){await (0,s.default).fire({text:"This will become more user friendly in the future. Feel free to come back anytime. Now we'll take you back to the main trustroots site."}),globalThis.location.href="http://www.trustroots.org/search";return}(0,s.default).fire({text:"Great. Browse map to see other people's notes and right click (or long press on mobile) to add your own note. "})}}},{sweetalert2:"d7K5G","./nostr/keys":"8qDuN","./utils":"i8jxn","@parcel/transformer-js/src/esmodule-helpers.js":"k3151"}],"5uBnK":[function(e,t,r){var o=e("@parcel/transformer-js/src/esmodule-helpers.js");o.defineInteropFlag(r),o.export(r,"validateNip5",()=>i);var n=e("../constants"),s=e("../router"),l=e("../utils"),a=e("./keys");let i=async()=>{try{let e=(0,s.getTrustrootsUsernameFromLocation)();if(e.length<3){(0,l.alert)("Sorry, you need to click to this page from trustroots.org. Without doing that, this site won't work properly. Please go to www.trustroots.org and click the Notes link to come back here. #wBjsEe","You need to click from trustroots");return}let t=await fetch(`${n.TRUSTROOTS_NIP5_URL}?name=${e}`),r=await t.json(),o=r.names?.[e],i=await (0,a.getPublicKey)();o!==i&&(0,l.alert)("Your key doesn't match trustroots. Posting to the map will not work. Please sign out and sign in again with the nsec key that matches your trustroots npub key. #H9bEe2","Fatal error")}catch(e){(0,l.alert)(e,"Unexpected error")}}},{"../constants":"7NbOs","../router":"9sDGW","../utils":"i8jxn","./keys":"8qDuN","@parcel/transformer-js/src/esmodule-helpers.js":"k3151"}]},["dB2Fs"],"dB2Fs","parcelRequire31ee");
//# sourceMappingURL=index.30b99e4f.js.map
